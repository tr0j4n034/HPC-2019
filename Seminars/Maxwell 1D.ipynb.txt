{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1D Maxwell equations\n",
    "===========\n",
    "\n",
    "Maxwell's equations read (speed of light = 1):\n",
    "\n",
    "$$\n",
    "\\partial_t\\vec B = -\\mathrm{rot}\\vec E\\\\\n",
    "\\partial_t\\vec E = \\mathrm{rot}\\vec B\n",
    "$$\n",
    "\n",
    "Writing all the components we get for magnetic field:\n",
    "\n",
    "$$\n",
    "\\partial_t B_x = -\\left(\\partial_y E_z - \\partial_z E_y \\right)\\\\\n",
    "\\partial_t B_y = -\\left(\\partial_y E_x - \\partial_z E_z \\right)\\\\\n",
    "\\partial_t B_z = -\\left(\\partial_y E_y - \\partial_z E_x \\right)\\\\\n",
    "$$\n",
    "\n",
    "And for electric field:\n",
    "$$\n",
    "\\partial_t E_x = \\left(\\partial_y B_z - \\partial_z B_y \\right)\\\\\n",
    "\\partial_t E_y = \\left(\\partial_y B_x - \\partial_z B_z \\right)\\\\\n",
    "\\partial_t E_z = \\left(\\partial_y B_y - \\partial_z B_x \\right)\\\\\n",
    "$$\n",
    "\n",
    "Assume 1D geometry, i.e. everything depends only on $t$ and $x$ (infinitely large electromagnetic waves in $y$ and $z$ dimensions). Then we get:\n",
    "\n",
    "$$\n",
    "\\partial_t B_y = \\partial_x E_z\\\\\n",
    "\\partial_t B_z = -\\partial_x E_y\n",
    "$$\n",
    "\n",
    "and \n",
    "\n",
    "$$\n",
    "\\partial_t E_y= - \\partial_x B_z\\\\\n",
    "\\partial_t E_z= \\partial_x B_y\n",
    "$$\n",
    "\n",
    "One can see, that these 4 equations can be split into two parts (they are called polarizations of the wave): $E_y, B_z$ (p-polarization) and $E_z, B_y$ (s-polarization)\n",
    "\n",
    "We get two separate and completely independent sets of equations:\n",
    "\n",
    "1. P-polarization\n",
    "-----------------\n",
    "\n",
    "$$\n",
    "\\partial_t E_y= - \\partial_x B_z\\\\\n",
    "\\partial_t B_z = -\\partial_x E_y\n",
    "$$\n",
    "\n",
    "2. S-polarization\n",
    "-----------------\n",
    "\n",
    "$$\n",
    "\\partial_t E_z= \\partial_x B_y\\\\\n",
    "\\partial_t B_y = \\partial_x E_z\n",
    "$$\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Task 1\n",
    "------\n",
    "\n",
    "Before proceeding with numerical solution of these equations (let us for simplicity and saving time only deal with p-polarization today) think of a numerical scheme how to solve equations. There are many numerical methods to do this, but can you without looking further in the text come up with one? \n",
    "\n",
    "Tip: if you understand what a fractional (1/2) time or spatial step means - you can use it."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Numerical scheme\n",
    "----------------\n",
    "\n",
    "Let's look again at the equations for p-polarization:\n",
    "$$\n",
    "\\partial_t E_y= - \\partial_x B_z\\\\\n",
    "\\partial_t B_z = -\\partial_x E_y\n",
    "$$\n",
    "\n",
    "Lets sum equations and substract equations and use notation $F_+=E_y+B_z$ and $F_-=E_y-B_z$:\n",
    "\n",
    "$$\n",
    "\\left(\\partial_t + \\partial_x\\right)F_+ = 0\\\\\n",
    "\\left(\\partial_t - \\partial_x\\right)F_- = 0\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Task 2\n",
    "------\n",
    "\n",
    "One of the new fields $F_+$ and $F_-$ corresponds to the wave going from left to right and one to the wave going from right to left. Which is which?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Task 3\n",
    "------\n",
    "\n",
    "Derive the numerical scheme (consider the time step equals to spatial step, i.e. $\\Delta t$ = $\\Delta x$):\n",
    "\n",
    "$$\n",
    "F_{+,i}^{n+1} = F_{+,i-1}^n\\\\\n",
    "F_{-,i}^{n+1} = F_{-,i+1}^n\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Task 4\n",
    "------\n",
    "\n",
    "Consider 1D computational domain of length $L=2\\pi \\cdot 40$ (you can vary the numbers later), consider only  $F_+$\n",
    "\n",
    "$$\n",
    "\\Delta t = \\Delta x = \\frac{2\\pi}{1000}\n",
    "$$\n",
    "\n",
    "Initially there are no fields in the computational domain.\n",
    "\n",
    "Boundary condition:\n",
    "\n",
    "$$\n",
    "F_+(x=0,t)=sin(t),\\quad \\mathrm{if}\\quad t<2\\pi\\cdot 10\\\\\n",
    "F_+(x=0,t)=0, \\mathrm{otherwise}\n",
    "$$\n",
    "\n",
    "Write a code (for example in Python for prototyping) that solves 1D Maxwell equations.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Task 5\n",
    "------\n",
    "\n",
    "Write a code in C/C++ and parallelize it using OpenMP."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
